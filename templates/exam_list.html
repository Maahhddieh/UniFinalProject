{% extends "base.html" %}
{% load static %}

{% block title %}Exams - {{ course.title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/exam_list.css' %}">
{% endblock %}

{% block content %}
<div class="exam-list-container">
    <h2>📑 Exams for <span class="course-name">{{ course.title }}</span></h2>

    <a href="{% url 'course_detail' course.id %}" class="back-button">← Back to Course</a>

    {% if user.user_type == "teacher" %}
        <a href="{% url 'add_exam' course.id %}" class="btn-add-exam">➕ Add New Exam</a>
    {% endif %}

    {% if exams %}
        <div class="exam-cards">
            {% for exam in exams %}
                <div class="exam-card">
                    <h3>{{ exam.title }}</h3>
                    <p class="desc">{{ exam.description|truncatewords:20 }}</p>
                    <p class="meta">
                        📅 Deadline: {{ exam.deadline|date:"Y-m-d H:i" }}
                    </p>

                    {% if exam.file %}
                        <p>📂 <a href="{{ exam.file.url }}" target="_blank">Download Exam File</a></p>
                    {% endif %}

                    <div class="exam-actions">
                        <a href="{% url 'exam_submissions_view' exam.id %}" class="btn-view">🔎 View submissions</a>

                        {% if user == exam.course.teacher %}
                            <a href="{% url 'exam_update' exam.id %}" class="btn-edit">✏️ Edit</a>
                            <a href="{% url 'exam_delete' exam.id %}" class="btn-delete"
                               onclick="return confirm('Are you sure you want to delete this exam?');">🗑 Delete</a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="no-exams">No exams have been added for this course yet.</p>
    {% endif %}
</div>
{% endblock %}
